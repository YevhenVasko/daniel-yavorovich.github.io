Title: Быстрая настройка NFS-сервера и клиента в CentOS Linux
Date: 2012-01-15 16:29:35
Slug: bystraya-nastrojka-nfs-servera-i-klienta-v-centos-


Здравствуйте!

Сегодня я расскажу как быстро настроить сервер и клиент для передачи данных по
замечательному протоколу NFS (Network File System).

#### Настройка NFS-сервера

В CentOS 6 minimal всё необходимое для работы уже есть, но если nfs-utils
среди пакетов Вы не находите, его можно установить:

    
    yum -y install nfs-utils nfs-utils-lib
    

Каталоги, доступ к которым мы открываем настраиваются в конфиге /etc/exports

Вот пример его содержания:

    
    /share/           192.168.0.100(rw,sync,no_root_squash,no_subtree_check)
    

В данном примере мы открываем каталог /share/ и всего его содержимое в полный
доступ только для клиента с IP 192.168.0.100.

Запускаем необходимые сервисы и добавляем их в автозапуск:

    
    service rpcbind restart
    service nfs start
    chkconfig rpcbind on
    chkconfig nfs on
    

Не забываем разрешить в Firewall доступ к NFS-серверу:

    
    iptables -A RH-Firewall-1-INPUT -s 192.168.0.100/24 -m state --state NEW -p tcp --dport 2049 -j ACCEPT
    service iptables save
    

### Настройка

NFS-клиента

На стороне клиента так же должна быть поддержка NFS в ядре. В случае с CentOS
5 и выше и стандартным ядром такая поддержка имеется.

Правим /etc/fstab, указывая адрес удалённого сервера, расшареный каталог и
каталог для монтирования:

    
    192.168.0.1:/share/ /mnt/share      nfs     defaults,users  0 0
    

В данном случае мы монтируем /share/ с сервера с IP 192.168.0.1 в /mnt/share.
В опциях монтирования мы указываем, что в каталогу могут иметь доступ обычные
пользователи. Так же каталог будет монтироваться автоматически при загрузке
системы.

Выполняем монтирование руками:

    
    mount /mnt/share
    

Если никаких ошибок не увидели - значит всё прошло, как нужно. Если же есть -
смотрите /var/log/messages на обоих серверах на предмет ошибок от nfs, хотя
mount, как правило, достаточно информативно отвечает в случае, если есть
проблемы.

